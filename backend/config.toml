# =============================================================================
# ERP Backend Configuration
# =============================================================================
# This is the default configuration. Environment-specific overrides:
#   - config.dev.toml (development)
#   - config.test.toml (testing)
#   - config.prod.toml (production)
#
# Environment variables can override any setting using the prefix "ERP_"
# Example: ERP_DATABASE_PASSWORD=xxx overrides [database] password
# =============================================================================

[app]
name = "erp-backend"
port = "8080"

[database]
host = "localhost"
port = 5432
user = "postgres"
password = "admin123"
dbname = "erp_dev"
sslmode = "disable"
max_open_conns = 25
max_idle_conns = 5
conn_max_lifetime = 60  # minutes
conn_max_idle_time = 30 # minutes

[redis]
host = "localhost"
port = 6379
password = ""
db = 0

[jwt]
secret = ""
access_token_expiration = "15m"
refresh_token_expiration = "168h"
issuer = "erp-backend"
refresh_secret = ""
max_refresh_count = 10

[cookie]
# Domain for cookies (empty = current domain)
domain = ""
# Path for cookies
path = "/"
# Secure flag (should be true in production for HTTPS)
secure = false
# SameSite policy: "strict", "lax", or "none"
same_site = "lax"

[log]
level = "info"
format = "console"
output = "stdout"

[event]
processor_enabled = true
batch_size = 100
poll_interval = "5s"
max_retries = 5
cleanup_enabled = true
cleanup_retention = "168h"

[http]
read_timeout = "15s"
write_timeout = "15s"
idle_timeout = "60s"
max_header_bytes = 1048576    # 1MB
max_body_size = 10485760      # 10MB
rate_limit_enabled = true
rate_limit_requests = 100
rate_limit_window = "1m"
# For cookie-based auth with credentials, use specific origins (not "*")
# In production, set to your actual frontend origin
cors_allow_origins = ["http://localhost:3000", "http://127.0.0.1:3000"]
cors_allow_methods = ["GET", "POST", "PUT", "DELETE", "PATCH", "OPTIONS"]
cors_allow_headers = ["Content-Type", "Authorization", "X-Request-ID", "X-Tenant-ID"]
trusted_proxies = []

[scheduler]
enabled = true
daily_cron_schedule = "0 2 * * *"  # 2am daily
max_concurrent_jobs = 3
job_timeout = "30m"
retry_attempts = 3
retry_delay = "5m"

[stock_lock]
# Stock lock expiration check interval
check_interval = "5m"
# Default lock expiration duration (24 hours as per spec)
default_expiration = "24h"
# Enable automatic expiration cleanup
auto_release_enabled = true
