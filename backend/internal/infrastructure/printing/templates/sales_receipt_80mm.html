<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>销售收据 - {{ .Document.ReceiptNo }}</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: "Microsoft YaHei", "SimSun", Arial, sans-serif;
            font-size: 10px;
            line-height: 1.4;
            color: #000;
            width: 76mm;
        }
        .receipt {
            width: 76mm;
            padding: 2mm;
        }
        /* Header */
        .header {
            text-align: center;
            padding-bottom: 5px;
            border-bottom: 2px solid #000;
            margin-bottom: 5px;
        }
        .store-name {
            font-size: 14px;
            font-weight: bold;
        }
        .store-info {
            font-size: 9px;
            color: #333;
            margin-top: 2px;
        }
        /* Receipt Info */
        .receipt-info {
            font-size: 9px;
            margin-bottom: 5px;
            padding-bottom: 5px;
            border-bottom: 1px dashed #000;
        }
        .receipt-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1px;
        }
        /* Items Table */
        .items-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 5px;
        }
        .items-table th,
        .items-table td {
            padding: 3px 2px;
            text-align: left;
            font-size: 9px;
        }
        .items-table th {
            border-bottom: 1px solid #000;
            font-weight: bold;
        }
        .items-table td {
            border-bottom: 1px dotted #ccc;
        }
        .items-table .col-name { width: auto; }
        .items-table .col-qty { width: 35px; text-align: center; }
        .items-table .col-price { width: 45px; text-align: right; }
        .items-table .col-amount { width: 50px; text-align: right; }
        /* Totals */
        .totals {
            margin-bottom: 5px;
            padding: 5px 0;
            border-top: 1px dashed #000;
            border-bottom: 1px dashed #000;
        }
        .total-row {
            display: flex;
            justify-content: space-between;
            font-size: 10px;
            margin-bottom: 2px;
        }
        .total-row.grand {
            font-size: 13px;
            font-weight: bold;
            margin-top: 3px;
            padding-top: 3px;
            border-top: 1px solid #ccc;
        }
        .total-row.discount {
            color: #c00;
        }
        /* Payments */
        .payments {
            margin-bottom: 5px;
            padding-bottom: 5px;
            border-bottom: 1px dashed #000;
        }
        .payments-title {
            font-size: 9px;
            font-weight: bold;
            margin-bottom: 3px;
        }
        .payment-row {
            display: flex;
            justify-content: space-between;
            font-size: 10px;
            margin-bottom: 1px;
        }
        .change-row {
            font-weight: bold;
            font-size: 11px;
        }
        /* Chinese Amount */
        .chinese-amount {
            text-align: center;
            font-size: 9px;
            color: #666;
            margin-bottom: 5px;
        }
        /* Footer */
        .footer {
            text-align: center;
            font-size: 8px;
            color: #666;
            padding-top: 5px;
        }
        .footer .thanks {
            font-size: 11px;
            font-weight: bold;
            margin-bottom: 3px;
        }
        .qr-placeholder {
            text-align: center;
            margin: 5px 0;
            padding: 10px;
            border: 1px dashed #ccc;
            font-size: 8px;
            color: #999;
        }
        /* Remark */
        .remark {
            font-size: 8px;
            color: #666;
            margin-top: 3px;
            padding: 3px;
            background-color: #f9f9f9;
        }
        /* Print */
        @media print {
            body { width: 76mm; }
            .receipt { padding: 0; }
        }
    </style>
</head>
<body>
    <div class="receipt">
        <!-- Header -->
        <div class="header">
            <div class="store-name">{{ .Document.Store.Name }}</div>
            {{ if .Document.Store.Address }}
            <div class="store-info">{{ .Document.Store.Address }}</div>
            {{ end }}
            {{ if .Document.Store.Phone }}
            <div class="store-info">电话: {{ .Document.Store.Phone }}</div>
            {{ end }}
        </div>

        <!-- Receipt Info -->
        <div class="receipt-info">
            <div class="receipt-row">
                <span>单号: {{ .Document.ReceiptNo }}</span>
                <span>收银员: {{ .Document.Cashier }}</span>
            </div>
            <div class="receipt-row">
                <span>日期: {{ .Document.TransactedAtFormatted }}</span>
            </div>
        </div>

        <!-- Items Table -->
        <table class="items-table">
            <thead>
                <tr>
                    <th class="col-name">商品名称</th>
                    <th class="col-qty">数量</th>
                    <th class="col-price">单价</th>
                    <th class="col-amount">金额</th>
                </tr>
            </thead>
            <tbody>
                {{ range .Document.Items }}
                <tr>
                    <td class="col-name">{{ truncate .ProductName 14 }}</td>
                    <td class="col-qty">{{ formatDecimal .Quantity 0 }}</td>
                    <td class="col-price">{{ formatMoney .UnitPrice }}</td>
                    <td class="col-amount">{{ formatMoney .Amount }}</td>
                </tr>
                {{ end }}
            </tbody>
        </table>

        <!-- Totals -->
        <div class="totals">
            <div class="total-row">
                <span>小计 ({{ .Document.ItemCount }}件 / {{ formatDecimal .Document.TotalQuantity 0 }}个)</span>
                <span>{{ .Document.SubtotalFormatted }}</span>
            </div>
            {{ if gt .Document.DiscountTotal.IntPart 0 }}
            <div class="total-row discount">
                <span>优惠金额</span>
                <span>-{{ .Document.DiscountTotalFormatted }}</span>
            </div>
            {{ end }}
            {{ if gt .Document.TaxTotal.IntPart 0 }}
            <div class="total-row">
                <span>税额</span>
                <span>{{ .Document.TaxTotalFormatted }}</span>
            </div>
            {{ end }}
            <div class="total-row grand">
                <span>应付金额</span>
                <span>{{ .Document.GrandTotalFormatted }}</span>
            </div>
        </div>

        <!-- Payments -->
        <div class="payments">
            <div class="payments-title">支付方式</div>
            {{ range .Document.Payments }}
            <div class="payment-row">
                <span>{{ .MethodText }}</span>
                <span>{{ .AmountFormatted }}</span>
            </div>
            {{ end }}
            {{ if gt .Document.Change.IntPart 0 }}
            <div class="payment-row change-row">
                <span>找零</span>
                <span>{{ .Document.ChangeFormatted }}</span>
            </div>
            {{ end }}
        </div>

        <!-- Chinese Amount -->
        <div class="chinese-amount">
            金额大写: {{ moneyToChinese .Document.GrandTotal }}
        </div>

        <!-- Remark -->
        {{ if .Document.Remark }}
        <div class="remark">
            备注: {{ .Document.Remark }}
        </div>
        {{ end }}

        <!-- QR Code Placeholder -->
        {{ if .Document.QRCode }}
        <div class="qr-placeholder">
            [电子发票二维码]<br>
            扫码开具电子发票
        </div>
        {{ end }}

        <!-- Footer -->
        <div class="footer">
            <div class="thanks">谢谢惠顾，欢迎再来!</div>
            {{ if .Document.Store.TaxID }}
            <div>税号: {{ .Document.Store.TaxID }}</div>
            {{ end }}
            <div>打印时间: {{ .PrintDateTime }}</div>
        </div>
    </div>
</body>
</html>
